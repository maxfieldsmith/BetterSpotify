{"version":3,"sources":["Login.js","TrackSearchResult.js","Player.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","href","TrackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","height","width","alt","title","artist","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","styles","bgColor","color","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","headers","then","res","data","console","log","window","history","pushState","catch","error","response","status","request","message","location","axiosConfig","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","fontSize","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.dd5e0b9d.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { Container } from \"react-bootstrap\";\r\n\r\nconst AUTH_URL =\r\n  \"https://accounts.spotify.com/authorize?client_id=1cebb523221b4c74addec1db4693f2ea&response_type=code&redirect_uri=https://better-spotify-maxfield.herokuapp.com&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\";\r\n\r\nexport default function Login() {\r\n  return (\r\n    <Container\r\n      className=\"d-flex justify-content-center align-items-center\"\r\n      style={{ minHeight: \"100vh\" }}\r\n    >\r\n      <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>\r\n        Login With Spotify\r\n      </a>\r\n    </Container>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nexport default function TrackSearchResult({ track, chooseTrack }) {\r\n  function handlePlay() {\r\n    chooseTrack(track);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className=\"d-flex m-2 align-items-center\"\r\n      style={{ cursor: \"pointer\" }}\r\n      onClick={handlePlay}\r\n    >\r\n      <img\r\n        src={track.albumUrl}\r\n        style={{ height: \"64px\", width: \"64px\" }}\r\n        alt=\"Album Cover\"\r\n      />\r\n      <div className=\"ml-3\">\r\n        <div>{track.title}</div>\r\n        <div className=\"text-muted\">{track.artist}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport SpotifyPlayer from \"react-spotify-web-playback\";\r\n\r\nexport default function Player({ accessToken, trackUri }) {\r\n  const [play, setPlay] = useState(false);\r\n\r\n  useEffect(() => setPlay(true), [trackUri]);\r\n\r\n  if (!accessToken) return null;\r\n  return (\r\n    <SpotifyPlayer\r\n      token={accessToken}\r\n      showSaveIcon\r\n      callback={(state) => {\r\n        if (!state.isPlaying) setPlay(false);\r\n      }}\r\n      play={play}\r\n      uris={trackUri ? [trackUri] : []}\r\n      styles={{ bgColor: \"#fff\", color: \"#333\", height: \"72px\" }}\r\n    />\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { Container, Form } from \"react-bootstrap\";\r\nimport useAuth from \"./useAuth\";\r\nimport SpotifyWebApi from \"spotify-web-api-node\";\r\nimport TrackSearchResult from \"./TrackSearchResult\";\r\nimport Player from \"./Player\";\r\nimport axios from \"axios\";\r\n\r\nconst spotifyApi = new SpotifyWebApi({\r\n  clientId: \"1cebb523221b4c74addec1db4693f2ea\",\r\n});\r\n\r\nexport default function Dashboard({ code }) {\r\n  const accessToken = useAuth(code);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [playingTrack, setPlayingTrack] = useState();\r\n  const [lyrics, setLyrics] = useState(\"\");\r\n\r\n  function chooseTrack(track) {\r\n    setPlayingTrack(track);\r\n    setSearch(\"\");\r\n    setLyrics(\"\");\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!playingTrack) return;\r\n\r\n    axios\r\n      .get(\"/lyrics\", {\r\n        params: {\r\n          track: playingTrack.title,\r\n          artist: playingTrack.artist,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        setLyrics(res.data.lyrics);\r\n      });\r\n  }, [playingTrack]);\r\n\r\n  useEffect(() => {\r\n    if (!accessToken) return;\r\n    spotifyApi.setAccessToken(accessToken);\r\n  }, [accessToken]);\r\n\r\n  useEffect(() => {\r\n    if (!search) return setSearchResults([]);\r\n    if (!accessToken) return;\r\n\r\n    let cancel = false;\r\n    spotifyApi.searchTracks(search).then((res) => {\r\n      if (cancel) return;\r\n      setSearchResults(\r\n        res.body.tracks.items.map((track) => {\r\n          const smallestAlbumImage = track.album.images.reduce(\r\n            (smallest, image) => {\r\n              if (image.height < smallest.height) return image;\r\n              return smallest;\r\n            },\r\n            track.album.images[0]\r\n          );\r\n\r\n          return {\r\n            artist: track.artists[0].name,\r\n            title: track.name,\r\n            uri: track.uri,\r\n            albumUrl: smallestAlbumImage.url,\r\n          };\r\n        })\r\n      );\r\n    });\r\n\r\n    return () => (cancel = true);\r\n  }, [search, accessToken]);\r\n\r\n  return (\r\n    <Container className=\"d-flex flex-column py-2\" style={{ height: \"100vh\" }}>\r\n      <Form.Control\r\n        type=\"search\"\r\n        placeholder=\"Search Songs/Artists\"\r\n        value={search}\r\n        onChange={(e) => setSearch(e.target.value)}\r\n      />\r\n      <div className=\"flex-grow-1 my-2\" style={{ overflowY: \"auto\" }}>\r\n        {searchResults.map((track) => (\r\n          <TrackSearchResult\r\n            track={track}\r\n            key={track.uri}\r\n            chooseTrack={chooseTrack}\r\n          />\r\n        ))}\r\n        {searchResults.length === 0 && (\r\n          <div\r\n            className=\"text-center\"\r\n            style={{ whiteSpace: \"pre\", fontSize: \"24px\" }}\r\n          >\r\n            {lyrics}\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div>\r\n        <Player accessToken={accessToken} trackUri={playingTrack?.uri} />\r\n      </div>\r\n    </Container>\r\n  );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport default function useAuth(code) {\r\n  const [accessToken, setAccessToken] = useState();\r\n  const [refreshToken, setRefreshToken] = useState();\r\n  const [expiresIn, setExpiresIn] = useState();\r\n\r\n  useEffect(() => {\r\n    let axiosConfig = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        \"Access-Control-Allow-Origin\": \"*\",\r\n        \"Access-Control-Allow-Methods\": \"POST\",\r\n      },\r\n    };\r\n    axios\r\n      .post(\r\n        \"/login\",\r\n        {\r\n          code,\r\n        },\r\n        axiosConfig\r\n      )\r\n      .then((res) => {\r\n        setAccessToken(res.data.accessToken);\r\n        setRefreshToken(res.data.refreshToken);\r\n        setExpiresIn(res.data.expiresIn);\r\n        console.log(res.data);\r\n        window.history.pushState({}, null, \"/\");\r\n      })\r\n      .catch((error) => {\r\n        if (error.response) {\r\n          // Request made and server responded\r\n          console.log(error.response.data);\r\n          console.log(error.response.status);\r\n          console.log(error.response.headers);\r\n        } else if (error.request) {\r\n          // The request was made but no response was received\r\n          console.log(error.request);\r\n        } else {\r\n          // Something happened in setting up the request that triggered an Error\r\n          console.log(\"Error\", error.message);\r\n        }\r\n        window.location = \"/\";\r\n      });\r\n  }, [code]);\r\n\r\n  useEffect(() => {\r\n    let axiosConfig = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        \"Access-Control-Allow-Origin\": \"*\",\r\n        \"Access-Control-Allow-Methods\": \"POST\",\r\n      },\r\n    };\r\n    if (!refreshToken || !expiresIn) return;\r\n    const interval = setInterval(() => {\r\n      axios\r\n        .post(\r\n          \"/refresh\",\r\n          {\r\n            refreshToken,\r\n          },\r\n          axiosConfig\r\n        )\r\n        .then((res) => {\r\n          setAccessToken(res.data.accessToken);\r\n          setExpiresIn(res.data.expiresIn);\r\n        })\r\n        .catch(() => {\r\n          window.location = \"/\";\r\n        });\r\n    }, (expiresIn - 60) * 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [refreshToken, expiresIn]);\r\n\r\n  return accessToken;\r\n}\r\n","import \"bootstrap/dist/css/bootstrap.min.css\";\nimport Login from \"./Login\";\nimport Dashboard from \"./Dashboard\";\n\nconst code = new URLSearchParams(window.location.search).get(\"code\");\n\nfunction App() {\n  return code ? <Dashboard code={code} /> : <Login />;\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}